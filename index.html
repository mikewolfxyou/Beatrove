<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="DJ Total Kaos - EDM Bangers Tracklist - Find and filter electronic music tracks by BPM, key, and genre">
  <!-- Content Security Policy with inline support for audio player -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob: http://localhost:9000; media-src 'self' blob:; font-src 'self'; connect-src 'self' http://localhost:9000;">
  <title>DJ Total Kaos - EDM Bangers</title>
  <link rel="stylesheet" href="assets/style.css" />
  <link rel="stylesheet" href="themes/color-drip.css" />
  <link rel="stylesheet" href="themes/shooting-stars.css" />
  <link rel="stylesheet" href="themes/parallax-stars.css" />
  <link rel="stylesheet" href="themes/gradient.css" />
  <!-- rest of head -->
</head>
<body id="top">
  <!-- Color Drip animated background lines -->
  <div class="color-drip-lines" style="display: none;">
    <div class="color-drip-line"></div>
    <div class="color-drip-line"></div>
    <div class="color-drip-line"></div>
    <div class="color-drip-line"></div>
    <div class="color-drip-line"></div>
    <div class="color-drip-line"></div>
    <div class="color-drip-line"></div>
    <div class="color-drip-line"></div>
    <div class="color-drip-line"></div>
    <div class="color-drip-line"></div>
  </div>

  <!-- Shooting Stars animated background -->
  <div class="shooting-stars-bg" style="display: none;">
    <div class="stars"></div>
    <div class="shooting-star"></div>
    <div class="shooting-star"></div>
    <div class="shooting-star"></div>
  </div>

  <!-- Parallax Stars animated background -->
  <div class="parallax-stars-bg" style="display: none;">
    <div id="stars-small"></div>
    <div id="stars-medium"></div>
    <div id="stars-large"></div>
  </div>

  <!-- Gradient animated waves -->
  <div class="gradient-waves" style="display: none;">
    <div class="wave"></div>
    <div class="wave"></div>
    <div class="wave"></div>
  </div>

  <div class="top-right-controls">
    <div class="theme-selector">
      <label for="theme-select" title="Choose Theme">ğŸ­</label>
      <select id="theme-select">
        <option value="default" selected>Default</option>
        <option value="gradient">Gradient</option>
        <option value="color-drip">Color Drip</option>
        <option value="shooting-stars">Shooting Stars</option>
        <option value="parallax-stars">Parallax Stars</option>
      </select>
    </div>
    <div class="accent-color-selector">
      <label for="accent-color-select" title="Choose Accent Color">ğŸ¨</label>
      <select id="accent-color-select">
        <option value="cyan">Cyan</option>
        <option value="red" selected>Red</option>
        <option value="green">Green</option>
        <option value="orange">Orange</option>
      </select>
    </div>
    <div class="theme-toggle-container">
      <label class="theme-switch" for="theme-toggle" title="Toggle Light/Dark Mode">
        <input type="checkbox" id="theme-toggle">
        <span class="slider"></span>
      </label>
    </div>
  </div>
  <div class="logo-container">
    <img src="beatrove-logo.png" alt="Beatrove" class="logo-image" />
  </div>
  <canvas id="top-audio-visualizer" width="800" height="60"></canvas>
  <div class="header-container">
    <div class="app-controls">
      <div class="top-controls-row">
        <button id="export-tags" class="control-btn">Export Tags</button>
        <button id="import-tags-btn" class="control-btn">Import Tags</button>
        <input type="file" id="import-tags-input" accept="application/json" class="hidden">
        <button id="export-all" class="control-btn" title="Export playlists, smart playlists, favorites, tags, mood/vibe tags, and energy levels">ğŸ“¥ Export All</button>
        <label for="import-all-input" class="control-btn cursor-pointer">ğŸ“¤ Import All</label>
        <input type="file" id="import-all-input" accept="application/json" class="hidden">
        <label for="tracklist-upload" class="control-btn">ğŸ“ Upload Tracklist</label>
        <input type="file" id="tracklist-upload" accept=".txt,.csv,.yaml,.yml" class="hidden">
        <input type="file" id="audio-folder-input" webkitdirectory directory multiple class="hidden">
        <button id="duplicates-toggle-btn" class="control-btn">ğŸ” Duplicate Tracks</button>
        <button id="compare-tracklist-btn" class="control-btn">ğŸ”„ Compare Tracklist</button>
        <input type="file" id="compare-tracklist-input" accept=".txt,.csv" class="hidden">
      </div>
      <div class="top-controls-row margin-top-small">
        <button id="favorites-toggle-btn" class="control-btn">â˜… Favorites</button>
        <button id="export-favorites-btn" class="control-btn">ğŸ’¾ Export Favorites</button>
        <button id="stats-toggle-btn" class="control-btn">ğŸ“Š Library Stats</button>
        <button id="vinyl-intake-toggle-btn" class="control-btn" style="display: none;">ğŸ’¿ Vinyl Intake</button>
        <button id="cover-art-toggle-btn" class="control-btn">ğŸ¨ Cover Art</button>
        <select id="waveform-style-select" class="control-btn waveform-style-dropdown">
          <option value="" disabled selected>Waveform Style</option>
          <option value="default">Default (Cyan)</option>
          <option value="soundcloud">SoundCloud (Orange)</option>
          <option value="spotify">Spotify (Green)</option>
          <option value="audacity">Audacity (Blue Stereo)</option>
          <option value="logic">Logic Pro (Colored)</option>
          <option value="overview">Full Track Overview</option>
        </select>
        <a href="User_Documentation.html" id="help-btn" class="control-btn no-text-decoration" target="_blank">â“ Help</a>
      </div>
    </div>
    <h1 id="editable-title" class="editable-title">DJ Total Kaos - EDM Bangers</h1>
    <div id="stats" class="library-summary-stats"></div>
  </div>
  <div id="vinyl-intake-container">
    <div class="search-section-card vinyl-card-hidden" id="vinyl-upload-card">
      <div class="filter-card-header">
        <span class="filter-card-icon">ğŸ’¿</span>
        <h3 class="filter-card-title">Vinyl Intake</h3>
      </div>
      <div class="vinyl-upload-content">
        <p class="vinyl-upload-description">
          Upload a sleeve photo and optional metadata; the local OCR server will populate the record catalog automatically.
        </p>
        <form id="vinyl-upload-form" class="vinyl-upload-form">
          <label class="vinyl-upload-file">
            <span>Cover Images * (front, back, inserts)</span>
            <input type="file" id="vinyl-cover-input" name="covers" accept="image/*" required multiple>
          </label>
          <div class="vinyl-upload-grid">
            <input type="text" id="vinyl-artist-input" name="artist" placeholder="Artist">
            <input type="text" id="vinyl-composer-input" name="composer" placeholder="Composer">
            <input type="text" id="vinyl-composer-code-input" name="composer_code" placeholder="Composer Catalog Code (e.g., KV 488)">
            <input type="text" id="vinyl-record-name-input" name="record_name" placeholder="Record / Release Name">
            <input type="text" id="vinyl-catalog-input" name="catalog_number" placeholder="Catalog #">
            <input type="text" id="vinyl-label-input" name="label" placeholder="Label">
            <input type="text" id="vinyl-year-input" name="year" placeholder="Year">
            <input type="text" id="vinyl-location-input" name="location" placeholder="Crate / Location">
          </div>
          <textarea id="vinyl-notes-input" name="notes" rows="3" placeholder="Notes (pressing details, condition, etc.)"></textarea>
          <div class="vinyl-upload-actions">
            <button type="submit" id="vinyl-upload-submit" class="vinyl-upload-btn">Upload Vinyl Record</button>
            <span id="vinyl-upload-status" class="vinyl-upload-status" aria-live="polite"></span>
          </div>
          <p class="vinyl-upload-hint">
            Requires the local vinyl API (`server/app.py`) to be running with `VINYL_MODE.ENABLED`.
          </p>
        </form>
      </div>
    </div>
  </div>
  <div id="search-container">
    <!-- Main Search Section -->
    <div class="search-section-card">
      <div class="filter-card-header">
        <span class="filter-card-icon">ğŸ”</span>
        <h3 class="filter-card-title">Search & Discovery</h3>
      </div>
      <div class="search-content">
        <div class="search-wrapper">
          <input type="text" id="search" placeholder="Search tracks, artists, or any metadata..." />
          <button type="button" id="clear-search" class="clear-search" title="Clear search">Ã—</button>
        </div>
        <div class="search-wrapper">
          <input type="text" id="artist-search" placeholder="Search by artist name only..." />
          <button type="button" id="clear-artist-search" class="clear-search" title="Clear artist search">Ã—</button>
        </div>
        <div class="fuzzy-search-toggle">
          <label class="fuzzy-toggle-label" for="fuzzy-search-toggle" title="Enable typo-tolerant search">
            <input type="checkbox" id="fuzzy-search-toggle">
            <span class="fuzzy-toggle-text">ğŸ”¤ Fuzzy Search</span>
          </label>
        </div>
      </div>
    </div>

    <!-- Filter Drawer Toggle -->
    <div class="filter-drawer-toggle">
      <button id="filter-drawer-btn" class="filter-toggle-btn collapsed" title="Toggle Filters">
        <span class="filter-toggle-icon">ğŸ›ï¸</span>
        <span class="filter-toggle-text">Search Filters</span>
        <span class="filter-toggle-arrow">â–¶</span>
      </button>
    </div>

    <!-- Collapsible Filter Drawer -->
    <div class="filter-drawer collapsed" id="filter-drawer">
      <!-- Filter Cards Container -->
      <div class="filters-container">
      <!-- Core Filters Card -->
      <div class="filter-card core-filters">
        <div class="filter-card-header">
          <span class="filter-card-icon">ğŸµ</span>
          <h3 class="filter-card-title">Core Filters</h3>
        </div>
        <div class="filter-grid">
          <div class="filter-item">
            <label for="bpm-filter">BPM</label>
            <select id="bpm-filter">
              <option value="">All BPMs</option>
            </select>
          </div>

          <div class="filter-item">
            <label for="key-filter">Key</label>
            <select id="key-filter">
              <option value="">All Keys</option>
            </select>
          </div>

          <div class="filter-item">
            <label for="year-search">Year</label>
            <input type="text" id="year-search" placeholder="e.g. 2023 or 2020-2023" />
          </div>

          <div class="filter-item">
            <label for="genre-filter">Genre</label>
            <select id="genre-filter">
              <option value="">All Genres</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Advanced Filters Card -->
      <div class="filter-card advanced-filters">
        <div class="filter-card-header">
          <span class="filter-card-icon">âš¡</span>
          <h3 class="filter-card-title">Advanced</h3>
        </div>
        <div class="filter-grid">
          <div class="filter-item">
            <label for="energy-filter">Energy</label>
            <select id="energy-filter">
              <option value="">All Energy Levels</option>
              <option value="1">1 â˜…â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†</option>
              <option value="2">2 â˜…â˜…â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†</option>
              <option value="3">3 â˜…â˜…â˜…â˜†â˜†â˜†â˜†â˜†â˜†â˜†</option>
              <option value="4">4 â˜…â˜…â˜…â˜…â˜†â˜†â˜†â˜†â˜†â˜†</option>
              <option value="5">5 â˜…â˜…â˜…â˜…â˜…â˜†â˜†â˜†â˜†â˜†</option>
              <option value="6">6 â˜…â˜…â˜…â˜…â˜…â˜…â˜†â˜†â˜†â˜†</option>
              <option value="7">7 â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜†â˜†â˜†</option>
              <option value="8">8 â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜†â˜†</option>
              <option value="9">9 â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜†</option>
              <option value="10">10 â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…</option>
            </select>
          </div>

          <div class="filter-item">
            <label for="tag-dropdown">Tags</label>
            <select id="tag-dropdown">
              <option value="">All Tags</option>
            </select>
          </div>

          <div class="filter-item">
            <label for="label-filter">Label</label>
            <select id="label-filter">
              <option value="">All Labels</option>
            </select>
          </div>

          <div class="filter-item">
            <label for="sort-select">Sort By</label>
            <select id="sort-select">
              <option value="name-asc">Artist (A-Z)</option>
              <option value="name-desc">Artist (Z-A)</option>
              <option value="tracks-desc">Most Tracks</option>
              <option value="tracks-asc">Fewest Tracks</option>
              <option value="bpm-asc">BPM (Low to High)</option>
              <option value="bpm-desc">BPM (High to Low)</option>
              <option value="key-asc">Key (A-Z)</option>
              <option value="key-desc">Key (Z-A)</option>
              <option value="title-asc">Title (A-Z)</option>
              <option value="title-desc">Title (Z-A)</option>
            </select>
          </div>
        </div>
      </div>
    </div>
    </div> <!-- Close filter-drawer -->
  </div>

  <div id="az-bar-container">
    <div id="az-bar">
      <!-- A-Z buttons will be generated by JS for accessibility and flexibility -->
    </div>
  </div>

  <div id="library-stats" class="library-stats hidden">
    <div class="stats-container">
      <h2>ğŸ“Š Music Library Statistics</h2>
      
      <div class="stats-grid">
        <div class="stat-section">
          <h3>ğŸ“ Overview</h3>
          <div class="stat-item">
            <span class="stat-label">Total Tracks:</span>
            <span class="stat-value" id="total-tracks">0</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Total Artists:</span>
            <span class="stat-value" id="total-artists">0</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Total Composers:</span>
            <span class="stat-value" id="total-composers">0</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Artist With Most Tracks:</span>
            <span class="stat-value" id="top-artist">-</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Composer With Most Tracks:</span>
            <span class="stat-value" id="top-composer">-</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Average Song Length:</span>
            <span class="stat-value" id="average-song-length">0:00</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Longest Song:</span>
            <span class="stat-value" id="longest-song">-</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Shortest Song:</span>
            <span class="stat-value" id="shortest-song">-</span>
          </div>
        </div>

        <div class="stat-section">
          <h3>ğŸ¤ Top 20 Artists</h3>
          <div class="chart-container">
            <canvas id="top-artists-chart"></canvas>
          </div>
        </div>

        <div class="stat-section quick-filter-section">
          <h3>âš¡ Quick Filters</h3>
          <div class="quick-filter-columns">
            <div class="quick-filter-column">
              <h4>Top Artists</h4>
              <div class="stats-list quick-filter-list" id="quick-filter-artists"></div>
            </div>
            <div class="quick-filter-column">
              <h4>Top Composers</h4>
              <div class="stats-list quick-filter-list" id="quick-filter-composers"></div>
            </div>
          </div>
          <button id="clear-quick-filters" class="control-btn">Clear Quick Filters</button>
        </div>

        <div class="stat-section">
          <h3>ğŸµ Genres</h3>
          <div class="chart-container">
            <canvas id="genre-chart"></canvas>
          </div>
          <div id="genre-stats" class="stat-list"></div>
        </div>

        <!-- Keys section with Camelot Wheel - full width row -->
        <div class="stat-section keys-section-full-width">
          <h3>ğŸ¹ Keys</h3>
          <div class="keys-content-wrapper">
            <div class="keys-chart-container">
              <div class="chart-container">
                <canvas id="key-chart"></canvas>
              </div>
              <div id="key-stats" class="stat-list"></div>
            </div>
            <div class="camelot-wheel-container">
              <img src="images/Camelot-Wheel.png" alt="Camelot Wheel" class="camelot-wheel-image">
            </div>
          </div>
        </div>

        <div class="stat-section">
          <h3>ğŸ¥ BPM Ranges</h3>
          <div class="chart-container">
            <canvas id="bpm-chart"></canvas>
          </div>
          <div id="bpm-stats" class="stat-list"></div>
        </div>

        <div class="stat-section">
          <h3>âš¡ Energy Levels</h3>
          <div class="chart-container">
            <canvas id="energy-chart"></canvas>
          </div>
          <div id="energy-stats" class="stat-list"></div>
        </div>

        <div class="stat-section years-section">
          <h3>ğŸ“… Years</h3>
          <div class="chart-container">
            <canvas id="year-chart"></canvas>
          </div>
          <div id="year-stats" class="stat-list"></div>
        </div>

        <div class="stat-section record-labels-section">
          <h3>ğŸ·ï¸ Record Labels</h3>
          <div class="chart-container">
            <canvas id="label-chart"></canvas>
          </div>
          <div id="label-stats" class="stat-list"></div>
        </div>
      </div>
    </div>
  </div>

  <div id="duplicate-tracks" class="duplicate-tracks hidden">
    <div class="duplicate-container">
      <h2>ğŸ” Duplicate Tracks <button id="close-duplicates" class="close-btn">âœ•</button></h2>
      <div id="duplicate-content">
        <!-- Duplicate tracks will be populated here -->
      </div>
    </div>
  </div>

  <div class="playlist-controls">
    <div class="filter-label playlist-select-wrapper">
      <span>Playlist</span>
      <select id="playlist-select">
        <option value="">Select Playlist</option>
      </select>
    </div>
    <button id="create-playlist-btn" class="control-btn">ğŸ“ New Playlist</button>
    <button id="create-smart-playlist-btn" class="control-btn">ğŸ§  Smart Playlist</button>
    <button id="edit-playlist-btn" class="control-btn" disabled>âœï¸ Edit</button>
    <button id="rename-playlist-btn" class="control-btn" disabled>ğŸ”„ Rename</button>
    <button id="delete-playlist-btn" class="control-btn" disabled>ğŸ—‘ï¸ Delete</button>
    <button id="export-playlist-btn" class="control-btn" disabled>Export Playlists</button>
    <button id="import-playlists-btn" class="control-btn">Import Playlists</button>
    <input type="file" id="import-playlists-input" accept=".json,.csv,application/json,text/csv" class="hidden">
  </div>

  <!-- Play Queue Controls -->
  <div class="play-queue-controls" id="play-queue-controls">
    <div class="queue-playback-controls">
      <button id="play-all-btn" class="control-btn queue-btn" title="Play all tracks in current view">â–¶ï¸ Play All</button>
      <button id="queue-prev-btn" class="control-btn queue-btn" disabled title="Previous track">â®ï¸</button>
      <button id="queue-pause-btn" class="control-btn queue-btn" disabled title="Pause/Resume">â¸ï¸</button>
      <button id="queue-next-btn" class="control-btn queue-btn" disabled title="Next track">â­ï¸</button>
      <button id="queue-stop-btn" class="control-btn queue-btn" disabled title="Stop playback">â¹ï¸</button>
    </div>
    <div class="queue-info" id="queue-info">
      <span id="queue-status">No queue active</span>
      <span id="queue-position"></span>
    </div>
    <div class="automix-controls">
      <label class="automix-toggle-label" title="Enable crossfade between tracks">
        <input type="checkbox" id="automix-toggle">
        <span>ğŸšï¸ Auto-Mix</span>
      </label>
      <div class="crossfade-settings" id="crossfade-settings" style="display: none;">
        <label for="crossfade-duration">Crossfade:</label>
        <input type="range" id="crossfade-duration" min="1" max="15" value="5" step="1">
        <span id="crossfade-value">5s</span>
      </div>
    </div>
  </div>

  <div class="pagination-controls">
    <div class="pagination-info">
      <span id="tracks-showing">Showing 0-0 of 0 tracks</span>
    </div>
    <div class="pagination-buttons">
      <button id="first-page-btn" class="control-btn" disabled>â®ï¸ First</button>
      <button id="prev-page-btn" class="control-btn" disabled>â¬…ï¸ Previous</button>
      <span id="page-info">Page 1 of 1</span>
      <button id="next-page-btn" class="control-btn" disabled>Next â¡ï¸</button>
      <button id="last-page-btn" class="control-btn" disabled>Last â­ï¸</button>
    </div>
    <div class="tracks-per-page">
      <label for="tracks-per-page-select">Tracks per page:</label>
      <select id="tracks-per-page-select">
        <option value="50">50</option>
        <option value="100" selected>100</option>
        <option value="250">250</option>
        <option value="500">500</option>
        <option value="all">Show All</option>
      </select>
    </div>
  </div>

  <div id="columns" class="columns">
    <div class="loader"></div>
  </div>

  <!-- Bottom Pagination Controls -->
  <div class="pagination-controls pagination-bottom">
    <div class="pagination-info">
      <span id="tracks-showing-bottom">Showing 0-0 of 0 tracks</span>
    </div>
    <div class="pagination-buttons">
      <button id="first-page-btn-bottom" class="control-btn" disabled>â®ï¸ First</button>
      <button id="prev-page-btn-bottom" class="control-btn" disabled>â¬…ï¸ Previous</button>
      <span id="page-info-bottom">Page 1 of 1</span>
      <button id="next-page-btn-bottom" class="control-btn" disabled>Next â¡ï¸</button>
      <button id="last-page-btn-bottom" class="control-btn" disabled>Last â­ï¸</button>
    </div>
    <div class="tracks-per-page">
      <label for="tracks-per-page-select-bottom">Tracks per page:</label>
      <select id="tracks-per-page-select-bottom">
        <option value="50">50</option>
        <option value="100" selected>100</option>
        <option value="250">250</option>
        <option value="500">500</option>
        <option value="all">Show All</option>
      </select>
    </div>
  </div>

  <canvas id="audio-visualizer" width="800" height="60"></canvas>

  <!-- Smart Playlist Creation Modal -->
  <div id="smart-playlist-modal" class="modal hidden">
    <div class="modal-content smart-playlist-content">
      <div class="modal-header">
        <h2>ğŸ§  Create Smart Playlist</h2>
        <button class="modal-close" id="close-smart-playlist-modal">âœ•</button>
      </div>

      <div class="modal-body">
        <div class="smart-playlist-name">
          <label for="smart-playlist-name-input">Playlist Name:</label>
          <input type="text" id="smart-playlist-name-input" placeholder="e.g., High Energy House, 90s Hip-Hop, Dinner Music">
        </div>

        <div class="smart-playlist-rules">
          <h3>Rules <span class="rule-logic-selector">
            <label>
              <input type="radio" name="rule-logic" value="AND" checked> All rules must match (AND)
            </label>
            <label>
              <input type="radio" name="rule-logic" value="OR"> Any rule can match (OR)
            </label>
          </span></h3>

          <div id="smart-playlist-rules-container">
            <!-- Rules will be added here dynamically -->
          </div>

          <button id="add-rule-btn" class="control-btn">+ Add Rule</button>
        </div>

        <div class="smart-playlist-preview">
          <h3>Preview (<span id="preview-count">0</span> tracks)</h3>
          <div id="smart-playlist-preview-tracks" class="preview-tracks-list">
            <!-- Preview tracks will be shown here -->
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button id="save-smart-playlist-btn" class="control-btn">Create Smart Playlist</button>
        <button id="cancel-smart-playlist-btn" class="control-btn">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Playlist Editor Modal -->
  <div id="playlist-editor-modal" class="modal hidden">
    <div class="modal-content playlist-editor-content">
      <div class="modal-header">
        <h2>âœï¸ Edit Playlist: <span id="playlist-editor-title"></span></h2>
        <button class="modal-close" id="close-playlist-editor-modal">âœ•</button>
      </div>

      <div class="modal-body">
        <div class="playlist-editor-info">
          <p>Total tracks: <strong><span id="playlist-editor-count">0</span></strong></p>
          <div id="smart-playlist-notice" class="smart-playlist-notice" style="display: none;">
            <p>âš ï¸ This is a smart playlist generated by rules. Tracks cannot be removed.</p>
            <p>You can convert this to a regular playlist to edit the track list.</p>
          </div>
        </div>

        <div class="playlist-editor-tracks" id="playlist-editor-tracks">
          <!-- Tracks will be listed here -->
        </div>
      </div>

      <div class="modal-footer">
        <button id="convert-to-regular-btn" class="control-btn convert-btn" style="display: none;">Convert to Regular</button>
        <button id="save-playlist-editor-btn" class="control-btn">Save & Close</button>
        <button id="cancel-playlist-editor-btn" class="control-btn">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Tracklist Comparison Modal -->
  <div id="tracklist-compare-modal" class="modal hidden">
    <div class="modal-content tracklist-compare-content">
      <div class="modal-header">
        <h2>ğŸ”„ Compare DJ Set Tracklist</h2>
        <button class="modal-close" id="close-compare-modal">âœ•</button>
      </div>

      <div class="modal-body">
        <div class="compare-upload-section">
          <div class="upload-dropzone" id="compare-dropzone">
            <p class="dropzone-text">ğŸ“‚ Drop your DJ set tracklist here or click to upload</p>
            <p class="dropzone-hint">Supports: TXT, CSV formats with timestamps, plain artist - title, or full tracklist format</p>
          </div>
        </div>

        <div class="compare-results-section" id="compare-results" style="display: none;">
          <div class="compare-stats">
            <div class="compare-stat-card">
              <span class="stat-number" id="compare-total-tracks">0</span>
              <span class="stat-label">Total Tracks</span>
            </div>
            <div class="compare-stat-card matched">
              <span class="stat-number" id="compare-matched-tracks">0</span>
              <span class="stat-label">Matched in Library</span>
            </div>
            <div class="compare-stat-card missing">
              <span class="stat-number" id="compare-missing-tracks">0</span>
              <span class="stat-label">Missing from Library</span>
            </div>
            <div class="compare-stat-card percentage">
              <span class="stat-number" id="compare-percentage">0%</span>
              <span class="stat-label">Match Rate</span>
            </div>
          </div>

          <div class="compare-tabs">
            <button class="compare-tab active" data-tab="all">All Tracks</button>
            <button class="compare-tab" data-tab="matched">Matched</button>
            <button class="compare-tab" data-tab="missing">Missing</button>
          </div>

          <div class="compare-tracks-list" id="compare-tracks-list">
            <!-- Tracks will be populated here -->
          </div>

          <div class="compare-export-buttons">
            <button id="export-missing-csv" class="control-btn" disabled>ğŸ“¥ Export Missing as CSV</button>
            <button id="export-missing-txt" class="control-btn" disabled>ğŸ“¥ Export Missing as TXT</button>
            <button id="export-matched-playlist" class="control-btn" disabled>ğŸ“¥ Create Playlist from Matched</button>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button id="close-compare-btn" class="control-btn">Close</button>
      </div>
    </div>
  </div>

  <!-- Cover Art Gallery Modal -->
  <div id="cover-gallery-modal" class="modal hidden" aria-hidden="true">
    <div class="modal-content cover-gallery-content">
      <div class="modal-header">
        <h2>ğŸ¨ Cover Gallery: <span id="cover-gallery-title"></span></h2>
        <button class="modal-close" id="close-cover-gallery-modal" aria-label="Close cover gallery">âœ•</button>
      </div>
      <div class="modal-body">
        <div id="cover-gallery-grid" class="cover-gallery-grid" role="list">
          <!-- Cover art thumbnails injected here -->
        </div>
        <p id="cover-gallery-empty" class="cover-gallery-empty" style="display: none;">
          No cover art was found for this track.
        </p>
      </div>
    </div>
  </div>

  <!-- Stats Section -->
  <div id="stats-section" class="overlay-section" style="display: none;">
    <div class="overlay-content">
      <div class="overlay-header">
        <h2>ğŸ“Š Library Statistics</h2>
        <button id="close-stats" class="close-btn">âœ•</button>
      </div>
      <div class="stats-grid">
        <div id="total-stats" class="stats-category">
          <h3>Overview</h3>
          <div class="stats-overview">
            <div class="overview-item">
              <span class="overview-label">Total Tracks</span>
              <span class="overview-value" id="total-tracks-count">0</span>
            </div>
            <div class="overview-item">
              <span class="overview-label">Total Artists</span>
              <span class="overview-value" id="total-artists-count">0</span>
            </div>
            <div class="overview-item">
              <span class="overview-label">Total Composers</span>
              <span class="overview-value" id="total-composers-count">0</span>
            </div>
            <div class="overview-item">
              <span class="overview-label">Artist With Most Tracks</span>
              <span class="overview-value" id="top-artist-count">-</span>
            </div>
            <div class="overview-item">
              <span class="overview-label">Composer With Most Tracks</span>
              <span class="overview-value" id="top-composer-count">-</span>
            </div>
            <div class="overview-item">
              <span class="overview-label">Average Song Length</span>
              <span class="overview-value" id="average-song-length-count">0:00</span>
            </div>
            <div class="overview-item">
              <span class="overview-label">Average BPM</span>
              <span class="overview-value" id="average-bpm">0</span>
            </div>
            <div class="overview-item">
              <span class="overview-label">Total Duration</span>
              <span class="overview-value" id="total-duration">0:00</span>
            </div>
          </div>
        </div>
        <div id="genre-stats" class="stats-category">
          <h3>Genre Distribution</h3>
          <div class="chart-container">
            <canvas id="genre-chart"></canvas>
          </div>
        </div>
        <div id="bpm-stats" class="stats-category">
          <h3>BPM Ranges</h3>
          <div class="chart-container">
            <canvas id="bpm-chart"></canvas>
          </div>
        </div>
        <div id="key-stats" class="stats-category">
          <h3>Key Distribution</h3>
          <div class="chart-container">
            <canvas id="key-chart"></canvas>
          </div>
        </div>
        <div id="energy-stats" class="stats-category">
          <h3>Energy Levels</h3>
          <div class="chart-container">
            <canvas id="energy-chart"></canvas>
          </div>
        </div>
        <div id="year-stats" class="stats-category">
          <h3>Years</h3>
          <div class="chart-container">
            <canvas id="year-chart"></canvas>
          </div>
        </div>
        <div id="label-stats" class="stats-category">
          <h3>Top Record Labels</h3>
          <div class="chart-container">
            <canvas id="labels-chart"></canvas>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Duplicates Section -->
  <div id="duplicates-section" class="overlay-section" style="display: none;">
    <div class="overlay-content">
      <div class="overlay-header">
        <h2>ğŸ” Duplicate Tracks</h2>
        <button id="close-duplicates" class="close-btn">âœ•</button>
      </div>
      <div id="duplicates-list" class="duplicates-container">
        <!-- Duplicate tracks will be rendered here -->
      </div>
    </div>
  </div>

  <footer>
    <div class="footer-content">
      <span id="footer-updated">Updated: never</span>
      <span class="float-right">&copy; 2025 <a href="https://totalkaos.net/" target="_blank" rel="noopener noreferrer" class="footer-link">DJ Total Kaos</a></span>
    </div>
    <div class="footer-border text-center">
      <a href="#top" class="control-btn no-text-decoration">â¬† Back to Top</a>
    </div>
  </footer>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
  <script type="module" src="assets/js/main.js" defer></script>
</body>
</html>
